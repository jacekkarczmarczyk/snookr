<!doctype html>
<title>Snookr</title>
<meta charset="utf-8"/>
<link rel="stylesheet" type="text/css" href="snookr.css" />
<div style="display: none">
    <img src="resources/cue.png" data-resource="cue" />
    <img src="resources/ball-red.png" data-resource="ball-red"/>
    <img src="resources/ball-white.png" data-resource="ball-white"/>
    <img src="resources/ball-yellow.png" data-resource="ball-yellow"/>
    <img src="resources/ball-green.png" data-resource="ball-green"/>
    <img src="resources/ball-brown.png" data-resource="ball-brown"/>
    <img src="resources/ball-blue.png" data-resource="ball-blue"/>
    <img src="resources/ball-pink.png" data-resource="ball-pink"/>
    <img src="resources/ball-black.png" data-resource="ball-black"/>

    <img src="resources/canvas.jpg" data-resource="canvas"/>

    <audio data-type="applause1" src="audio/applause1.mp3"></audio>
    <audio data-type="applause2" src="audio/applause2.mp3"></audio>
    <audio data-type="disappointment" src="audio/disappointment.mp3"></audio>
    <audio data-type="ball" src="audio/ball.mp3"></audio>
</div>

<snookr-ui-app></snookr-ui-app>

<script src="classes/Point.js"></script>
<script src="classes/LineSegment.js"></script>
<script src="classes/LineArc.js"></script>
<script src="classes/Vector.js"></script>
<script src="classes/Spin.js"></script>
<script src="classes/AudioClip.js"></script>
<script src="classes/ResourcesFactory.js"></script>
<script src="classes/SnookrView.js"></script>
<script src="classes/SnookrTable.js"></script>
<script src="classes/SnookrTableArcade.js"></script>
<script src="classes/SnookrTableRegular.js"></script>
<script src="classes/SnookrTableReal.js"></script>
<script src="classes/SnookrBall.js"></script>
<script src="classes/BallMovement.js"></script>
<script src="classes/SnookrBallSet.js"></script>
<script src="classes/SnookrPhysics.js"></script>
<script src="classes/SnookrGame.js"></script>
<script src="classes/SnookrGameArcade.js"></script>
<script src="classes/SnookrGameRegular.js"></script>
<script src="classes/SnookrGameReal.js"></script>
<script src="classes/SnookrGameTest.js"></script>
<script src="classes/SnookrGameState.js"></script>
<script src="classes/SnookrEvent.js"></script>
<script src="classes/SnookrEventListener.js"></script>
<script src="classes/SpinPower.js"></script>
<script src="classes/SnookrUI.js"></script>
<script src="classes/SnookrUIBoard.js"></script>
<script src="classes/SnookrUITable.js"></script>
<script src="classes/SnookrUISpinnerBall.js"></script>
<script src="classes/SnookrUIApp.js"></script>
<script src="classes/SnookrShotResult.js"></script>
<script src="classes/SnookrRule.js"></script>
<script src="classes/SnookrRuleExpectingAnyColor.js"></script>
<script src="classes/SnookrRuleExpectingColor.js"></script>
<script src="classes/SnookrRuleExpectingRed.js"></script>
<script src="classes/SnookrRuleFreeBall.js"></script>
<script src="classes/SnookrRuleRepeat.js"></script>
<script src="classes/SnookrHistory.js"></script>
<script src="classes/SnookrHistoryEntry.js"></script>
<script type="text/javascript">
    function createView() {
        return new SnookrUIApp(document.querySelector('snookr-ui-app'), {
            hash: document.location.hash,
            spinPower: new SpinPower()
        });
    }

    let view;

    window.addEventListener('hashchange', () => view = createView());
    window.addEventListener('load', () => view = createView());
    window.addEventListener('resize', () => view && view.getElement().dispatchEvent(new Event('snookrEvent.resize')));
    window.addEventListener('keydown', function({which, ctrlKey}) {
        let eventType;
        switch (which) {
            case 37:
                eventType = 'snookrEvent.arrowLeft';
                break;
            case 39:
                eventType = 'snookrEvent.arrowRight';
                break;
            case 38:
                eventType = 'snookrEvent.arrowDown';
                break;
            case 40:
                eventType = 'snookrEvent.arrowUp';
                break;
            case 90:
                eventType = ctrlKey ? 'snookrEvent.rollback' : null;
                break;
        }

        if (eventType) {
            view.getElement().dispatchEvent(new Event(eventType));
            return false;
        }
    });
</script>
